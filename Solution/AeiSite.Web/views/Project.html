
<style>
	h3 {
		color: #777;
		font-size: 12px;
		text-transform: uppercase;
		margin: 0;
	}
	
	p {
		color: #bbb;
		font-size: 14px;
		line-height: 18px;
	}
	
	p + h3 {
		margin-top: 10px;
	}
	
	.gallery .thumb {
		width: 100%;
		height: 40px;
		margin: 0 0 2px 0;
		display: none;
	}
	
	.gallery .thumb .overlay {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background-color: #555;
	}
</style>


<header style="padding: 16px;">
	<div style="float: left;">
		<a href="#/" style="width: 42px; height: 46px;" title="Aesthetic Interactive">
			<img src="img/Logo-Small-Dark.png" />
		</a>
	</div>

	<div style="padding-left: 16px; float: left;">
		<div class="tag" style="margin-top:  1px; background-color: #683; 
				color: rgba(255, 255, 255, 0.75);">
			Project
		</div>
		<div style="margin-top: 4px;">
			<p style="color: #fff; font-size: 24px; line-height: 20px; margin: 0;">
				{{model.project.name}}
			</p>
		</div>
	</div>

	<div style="clear: both;">
	</div>
</header>

<div class="row" style="background-color: #3a3a3a; padding-top: 16px; padding-bottom: 16px;">
	
	<div class="large-4 columns">
		<h3>
			Description
		</h3>
		<p>
			{{model.project.desc}}
		</p>
	</div>

	<div class="large-4 columns">
		<h3>
			Client
		</h3>
		<p>
			{{model.project.client}}
		</p>
		<h3>
			Timeline
		</h3>
		<p>
			{{model.project.start}} to {{model.project.end}}<br/>
		</p>
		<h3>
			Link
		</h3>
		<p>
			<a href="http://{{model.project.url}}">{{model.project.url}}</a>
		</p>
	</div>

	<div class="large-4 columns">
		<div class="gallery" style="font-size: 0;" ng-init="imgIds = [0,1,2,3,4,5,6,7]">
			
			<div id="thumb{{imgId}}" class="thumb" ng-repeat="imgId in imgIds">
				
				<div class="imageFill" 
					ng-init="imgUrl = 'img/projects/'+model.project.id+'/'+imgId+'.jpg'" 
					style="background-image: url({{imgUrl}});">
				</div>
				<img ng-src="{{imgUrl}}" data-index="{{imgId}}" style="display: none;"
					onload="Aei.CurrPage.onThumbLoad(this);" 
					onerror="Aei.CurrPage.onThumbFail(this);" />
				<div class="overlay">
				</div>
			</div>

		</div>
	</div>

</div>


<script>
	Aei.CurrPage = {};
	Aei.CurrPage.thumbs = [];
	Aei.CurrPage.thumbEventCount = 0;
	Aei.CurrPage.thumbActiveId = 0;

	Aei.CurrPage.onThumbLoad = function(img) {
		var index = $(img).attr('data-index');
		var thumb = $('#thumb'+index);
		var thumbOverlay = thumb.children('.overlay');

		thumb
			.show()
			.attr('data-w', $(img).width())
			.attr('data-h', $(img).height())
			.click(function() {
				Aei.CurrPage.setActiveThumb(index, false);
			});

		thumbOverlay.fadeTo(0, 0.8);

		Aei.CurrPage.thumbs[index] = thumb;
		++Aei.CurrPage.thumbEventCount;

		if ( index == Aei.CurrPage.thumbActiveId ) {
			Aei.CurrPage.updateActiveThumb();
		}
	};

	Aei.CurrPage.onThumbFail = function(img) {
		var index = $(img).attr('data-index');
		var thumb = $('#thumb'+index);
		thumb.hide();

		++Aei.CurrPage.thumbEventCount;
	};

	Aei.CurrPage.setActiveThumb = function(index) {
		if ( Aei.CurrPage.thumbActiveId != index ) {
			var thumb = $('#thumb'+Aei.CurrPage.thumbActiveId);
			thumb.animate({ height: '40px' }, 400);
			thumb.children('.overlay').fadeTo(400, 0.8);
		}

		if ( Aei.CurrPage.thumbActiveId == index ) {
			return;
		}
		
		Aei.CurrPage.thumbActiveId = index;
		Aei.CurrPage.updateActiveThumb(true);
	};
	
	Aei.CurrPage.updateActiveThumb = function(animate) {
		var duration = (animate ? 400 : 0);

		var thumb = $('#thumb'+Aei.CurrPage.thumbActiveId);
		var w = thumb.attr('data-w');
		var h = thumb.attr('data-h');
		h = thumb.width()/w*h;

		thumb.animate({ height: h+'px' }, duration);
		thumb.children('.overlay').fadeTo(duration, 0.0);
	};

	window.onresize = function() {
		Aei.CurrPage.updateActiveThumb(false);
	};
</script>

